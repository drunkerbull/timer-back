(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{ZAaW:function(n,l,t){"use strict";t.r(l);var e=t("CcnG"),u=function(){function n(){}return n.prototype.ngOnInit=function(){},n}(),o=function(){return function(){}}(),s=t("pMnS"),i=t("Ip0R"),r=t("gIcY"),c=function(){function n(n,l){this.messagesService=n,this.storageService=l,this.rooms=[],this.usersSearch=[],this.currentRoom=null,this.form=new r.g({search:new r.e("")}),this.searchIsEmpty=!0}return n.prototype.ngOnInit=function(){var n=this;this.messagesService.getRooms(),this.form.get("search").valueChanges.subscribe(function(l){l&&l.length?(n.searchIsEmpty=!1,n.messagesService.getSearchUsers(l)):(n.usersSearch=[],n.searchIsEmpty=!0)}),this.messagesService.onRoom().subscribe(function(l){n.currentRoom=l,n.rooms.filter(function(l){return l._id===n.currentRoom._id}).length||n.rooms.push(n.currentRoom)}),this.messagesService.onRooms().subscribe(function(l){n.rooms=l}),this.messagesService.onSearchUsers().subscribe(function(l){n.usersSearch=l})},n.prototype.selectUser=function(n){this.messagesService.selectOrCreateRoom(n),this.form.reset()},n.prototype.selectRoom=function(n){this.messagesService.selectRoom(n)},n.prototype.getRoomName=function(n){var l=this;return n.name||2!==n.group.length?this.currentRoom.name:n.group.find(function(n){return n._id!==l.storageService.user._id}).nickname},n}(),a=t("yFR0"),g=function(){function n(n){this.socketService=n}return n.prototype.getSearchUsers=function(n){this.socketService.emit("searchUsers",n.toLowerCase())},n.prototype.onSearchUsers=function(){return this.socketService.listen("onSearchUsers")},n.prototype.getRooms=function(){this.socketService.emit("rooms")},n.prototype.onRooms=function(){return this.socketService.listen("onRooms")},n.prototype.onRoom=function(){return this.socketService.listen("onRoom")},n.prototype.selectOrCreateRoom=function(n){this.socketService.emit("selectOrCreateRoom",n)},n.prototype.selectRoom=function(n){this.socketService.emit("selectRoom",n)},n.prototype.sendMessage=function(n){this.socketService.emit("message",n)},n.ngInjectableDef=e.Ib({factory:function(){return new n(e.Mb(a.a))},token:n,providedIn:"root"}),n}(),b=t("fbMX"),m=e.ob({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;width:25%;border-right:1px solid #000;height:calc(100vh - 76px)}.users-search[_ngcontent-%COMP%]{padding:16px;display:flex;border-bottom:1px solid grey}.users-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:4px}.search-list[_ngcontent-%COMP%]{background:silver}.rooms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .search-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{height:40px;display:flex;padding:8px;cursor:pointer}.rooms-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%], .rooms-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]:hover, .search-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%], .search-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]:hover{background:#708090}.rooms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover, .search-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#d3d3d3}.rooms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .room-avatar[_ngcontent-%COMP%], .search-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .room-avatar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20%}.rooms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .room-avatar[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%], .search-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .room-avatar[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{background:grey;width:40px;border-radius:100%;height:40px}"]],data:{}});function p(n){return e.Gb(0,[(n()(),e.qb(0,0,null,null,4,"li",[],[[2,"selected",null]],[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.selectRoom(n.context.$implicit)&&e),e},null,null)),(n()(),e.qb(1,0,null,null,1,"div",[["class","room-avatar"]],null,null,null,null,null)),(n()(),e.qb(2,0,null,null,0,"span",[["class","avatar"]],null,null,null,null,null)),(n()(),e.qb(3,0,null,null,1,"span",[["class","room-name"]],null,null,null,null,null)),(n()(),e.Fb(4,null,["",""]))],null,function(n,l){var t=l.component;n(l,0,0,l.context.$implicit._id===(null==t.currentRoom?null:t.currentRoom._id)),n(l,4,0,t.getRoomName(l.context.$implicit))})}function d(n){return e.Gb(0,[(n()(),e.qb(0,0,null,null,2,"ul",[["class","rooms-list"]],null,null,null,null,null)),(n()(),e.fb(16777216,null,null,1,null,p)),e.pb(2,278528,null,0,i.i,[e.P,e.M,e.t],{ngForOf:[0,"ngForOf"]},null)],function(n,l){n(l,2,0,l.component.rooms)},null)}function h(n){return e.Gb(0,[(n()(),e.qb(0,0,null,null,6,"li",[],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.selectUser(n.context.$implicit)&&e),e},null,null)),(n()(),e.qb(1,0,null,null,1,"div",[["class","room-avatar"]],null,null,null,null,null)),(n()(),e.qb(2,0,null,null,0,"span",[["class","avatar"]],null,null,null,null,null)),(n()(),e.qb(3,0,null,null,3,"span",[["class","room-name"]],null,null,null,null,null)),(n()(),e.Fb(4,null,[" "," "])),(n()(),e.qb(5,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),e.Fb(6,null,[" "," "]))],null,function(n,l){n(l,4,0,l.context.$implicit.nickname),n(l,6,0,l.context.$implicit.email)})}function f(n){return e.Gb(0,[(n()(),e.qb(0,0,null,null,2,"ul",[["class","search-list"]],null,null,null,null,null)),(n()(),e.fb(16777216,null,null,1,null,h)),e.pb(2,278528,null,0,i.i,[e.P,e.M,e.t],{ngForOf:[0,"ngForOf"]},null)],function(n,l){n(l,2,0,l.component.usersSearch)},null)}function v(n){return e.Gb(0,[(n()(),e.fb(16777216,null,null,1,null,f)),e.pb(1,16384,null,0,i.j,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.fb(0,null,null,0))],function(n,l){n(l,1,0,!l.component.searchIsEmpty)},null)}function C(n){return e.Gb(0,[(n()(),e.qb(0,0,null,null,11,"div",[["class","users-search"]],null,null,null,null,null)),(n()(),e.qb(1,0,null,null,10,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],function(n,l,t){var u=!0;return"submit"===l&&(u=!1!==e.zb(n,3).onSubmit(t)&&u),"reset"===l&&(u=!1!==e.zb(n,3).onReset()&&u),u},null,null)),e.pb(2,16384,null,0,r.v,[],null,null),e.pb(3,540672,null,0,r.h,[[8,null],[8,null]],{form:[0,"form"]},null),e.Cb(2048,null,r.b,null,[r.h]),e.pb(5,16384,null,0,r.m,[[4,r.b]],null,null),(n()(),e.qb(6,0,null,null,5,"input",[["formControlName","search"],["placeholder","search"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,l,t){var u=!0;return"input"===l&&(u=!1!==e.zb(n,7)._handleInput(t.target.value)&&u),"blur"===l&&(u=!1!==e.zb(n,7).onTouched()&&u),"compositionstart"===l&&(u=!1!==e.zb(n,7)._compositionStart()&&u),"compositionend"===l&&(u=!1!==e.zb(n,7)._compositionEnd(t.target.value)&&u),u},null,null)),e.pb(7,16384,null,0,r.c,[e.E,e.k,[2,r.a]],null,null),e.Cb(1024,null,r.j,function(n){return[n]},[r.c]),e.pb(9,671744,null,0,r.f,[[3,r.b],[8,null],[8,null],[6,r.j],[2,r.t]],{name:[0,"name"]},null),e.Cb(2048,null,r.k,null,[r.f]),e.pb(11,16384,null,0,r.l,[[4,r.k]],null,null),(n()(),e.qb(12,0,null,null,3,"div",[["class","list"]],null,null,null,null,null)),(n()(),e.fb(16777216,null,null,1,null,d)),e.pb(14,16384,null,0,i.j,[e.P,e.M],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),e.fb(0,[["searchList",2]],null,0,null,v))],function(n,l){var t=l.component;n(l,3,0,t.form),n(l,9,0,"search"),n(l,14,0,t.searchIsEmpty,e.zb(l,15))},function(n,l){n(l,1,0,e.zb(l,5).ngClassUntouched,e.zb(l,5).ngClassTouched,e.zb(l,5).ngClassPristine,e.zb(l,5).ngClassDirty,e.zb(l,5).ngClassValid,e.zb(l,5).ngClassInvalid,e.zb(l,5).ngClassPending),n(l,6,0,e.zb(l,11).ngClassUntouched,e.zb(l,11).ngClassTouched,e.zb(l,11).ngClassPristine,e.zb(l,11).ngClassDirty,e.zb(l,11).ngClassValid,e.zb(l,11).ngClassInvalid,e.zb(l,11).ngClassPending)})}var P=function(){function n(n,l){this.messagesService=n,this.storageService=l,this.currentRoom=null,this.form=new r.g({message:new r.e("")})}return n.prototype.ngOnInit=function(){var n=this;this.messagesService.onRoom().subscribe(function(l){n.currentRoom=l})},Object.defineProperty(n.prototype,"groupList",{get:function(){return this.currentRoom.group.map(function(n){return n.nickname}).join(", ")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"roomName",{get:function(){var n=this;return this.currentRoom.name||2!==this.currentRoom.group.length?this.currentRoom.name:this.currentRoom.group.filter(function(l){return l._id!==n.storageService.user._id})[0].nickname},enumerable:!0,configurable:!0}),n.prototype.sendMessage=function(){var n={type:"message",room:this.currentRoom._id,owner:this.storageService.user._id,text:this.form.get("message").value};this.currentRoom.messages.push(n),this.messagesService.sendMessage(n),this.form.reset()},n}(),_=e.ob({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;width:75%;height:calc(100vh - 76px)}.messages-box[_ngcontent-%COMP%]{display:flex;height:100%;flex-flow:column;justify-content:space-between}.header[_ngcontent-%COMP%], .messages[_ngcontent-%COMP%]{padding:8px}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{height:calc(100vh - 225px);overflow-y:auto}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding-top:16px;padding-bottom:16px;display:flex;align-items:center}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]{width:15%;display:flex;align-items:center;justify-content:center}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{height:40px;width:40px;background:grey;border-radius:100%}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{width:85%;padding-right:16px}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.owner[_ngcontent-%COMP%]{background:#708090}.form[_ngcontent-%COMP%]{padding:8px;height:60px;display:flex;align-items:center;background:silver}"]],data:{}});function x(n){return e.Gb(0,[(n()(),e.qb(0,0,null,null,4,"li",[],[[2,"owner",null]],null,null,null,null)),(n()(),e.qb(1,0,null,null,1,"div",[["class","message-avatar"]],null,null,null,null,null)),(n()(),e.qb(2,0,null,null,0,"div",[["class","avatar"]],null,null,null,null,null)),(n()(),e.qb(3,0,null,null,1,"div",[["class","message-text"]],null,null,null,null,null)),(n()(),e.Fb(4,null,[" "," "]))],null,function(n,l){n(l,0,0,l.context.$implicit.owner===l.component.storageService.user._id),n(l,4,0,l.context.$implicit.text)})}function O(n){return e.Gb(0,[(n()(),e.qb(0,0,null,null,22,"div",[["class","messages-box"]],null,null,null,null,null)),(n()(),e.qb(1,0,null,null,3,"div",[["class","header"]],null,null,null,null,null)),(n()(),e.Fb(2,null,[" Room name: "," "])),(n()(),e.qb(3,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),e.Fb(4,null,[" Group: [","] "])),(n()(),e.qb(5,0,null,null,3,"div",[["class","messages"]],null,null,null,null,null)),(n()(),e.qb(6,0,null,null,2,"ul",[],null,null,null,null,null)),(n()(),e.fb(16777216,null,null,1,null,x)),e.pb(8,278528,null,0,i.i,[e.P,e.M,e.t],{ngForOf:[0,"ngForOf"]},null),(n()(),e.qb(9,0,null,null,13,"div",[["class","form"]],null,null,null,null,null)),(n()(),e.qb(10,0,null,null,12,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],function(n,l,t){var u=!0,o=n.component;return"submit"===l&&(u=!1!==e.zb(n,12).onSubmit(t)&&u),"reset"===l&&(u=!1!==e.zb(n,12).onReset()&&u),"ngSubmit"===l&&(u=!1!==o.sendMessage()&&u),u},null,null)),e.pb(11,16384,null,0,r.v,[],null,null),e.pb(12,540672,null,0,r.h,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),e.Cb(2048,null,r.b,null,[r.h]),e.pb(14,16384,null,0,r.m,[[4,r.b]],null,null),(n()(),e.qb(15,0,null,null,5,"input",[["formControlName","message"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,l,t){var u=!0;return"input"===l&&(u=!1!==e.zb(n,16)._handleInput(t.target.value)&&u),"blur"===l&&(u=!1!==e.zb(n,16).onTouched()&&u),"compositionstart"===l&&(u=!1!==e.zb(n,16)._compositionStart()&&u),"compositionend"===l&&(u=!1!==e.zb(n,16)._compositionEnd(t.target.value)&&u),u},null,null)),e.pb(16,16384,null,0,r.c,[e.E,e.k,[2,r.a]],null,null),e.Cb(1024,null,r.j,function(n){return[n]},[r.c]),e.pb(18,671744,null,0,r.f,[[3,r.b],[8,null],[8,null],[6,r.j],[2,r.t]],{name:[0,"name"]},null),e.Cb(2048,null,r.k,null,[r.f]),e.pb(20,16384,null,0,r.l,[[4,r.k]],null,null),(n()(),e.qb(21,0,null,null,1,"button",[["type","submit"]],null,null,null,null,null)),(n()(),e.Fb(-1,null,["Send"]))],function(n,l){var t=l.component;n(l,8,0,t.currentRoom.messages),n(l,12,0,t.form),n(l,18,0,"message")},function(n,l){var t=l.component;n(l,2,0,t.roomName),n(l,4,0,t.groupList),n(l,10,0,e.zb(l,14).ngClassUntouched,e.zb(l,14).ngClassTouched,e.zb(l,14).ngClassPristine,e.zb(l,14).ngClassDirty,e.zb(l,14).ngClassValid,e.zb(l,14).ngClassInvalid,e.zb(l,14).ngClassPending),n(l,15,0,e.zb(l,20).ngClassUntouched,e.zb(l,20).ngClassTouched,e.zb(l,20).ngClassPristine,e.zb(l,20).ngClassDirty,e.zb(l,20).ngClassValid,e.zb(l,20).ngClassInvalid,e.zb(l,20).ngClassPending)})}function M(n){return e.Gb(0,[(n()(),e.fb(16777216,null,null,1,null,O)),e.pb(1,16384,null,0,i.j,[e.P,e.M],{ngIf:[0,"ngIf"]},null)],function(n,l){n(l,1,0,l.component.currentRoom)},null)}var y=e.ob({encapsulation:0,styles:[[".messages[_ngcontent-%COMP%]{display:flex;border-right:1px solid #000;border-left:1px solid #000;border-bottom:1px solid #000;background:#fff}"]],data:{}});function S(n){return e.Gb(0,[(n()(),e.qb(0,0,null,null,4,"div",[["class","messages"]],null,null,null,null,null)),(n()(),e.qb(1,0,null,null,1,"app-sidebar",[],null,null,null,C,m)),e.pb(2,114688,null,0,c,[g,b.a],null,null),(n()(),e.qb(3,0,null,null,1,"app-messages-box",[],null,null,null,M,_)),e.pb(4,114688,null,0,P,[g,b.a],null,null)],function(n,l){n(l,2,0),n(l,4,0)},null)}function R(n){return e.Gb(0,[(n()(),e.qb(0,0,null,null,1,"app-messages",[],null,null,null,S,y)),e.pb(1,114688,null,0,u,[],null,null)],function(n,l){n(l,1,0)},null)}var k=e.mb("app-messages",u,R,{},{},[]),z=t("t/Na"),q=t("ZYCi"),w=t("XPwU"),I=t("yTb8"),j=t("NHGN"),F=t("SZbH"),G=t("Zseb"),E=t("PCNd"),N=function(){return function(){}}();t.d(l,"MessagesRoutingModuleNgFactory",function(){return U});var U=e.nb(o,[],function(n){return e.wb([e.xb(512,e.j,e.ab,[[8,[s.a,k]],[3,e.j],e.y]),e.xb(4608,i.l,i.k,[e.v,[2,i.t]]),e.xb(4608,r.s,r.s,[]),e.xb(4608,z.h,z.n,[i.c,e.C,z.l]),e.xb(4608,z.o,z.o,[z.h,z.m]),e.xb(4608,b.a,b.a,[q.k]),e.xb(4608,z.k,z.k,[]),e.xb(6144,z.i,null,[z.k]),e.xb(4608,z.g,z.g,[z.i]),e.xb(6144,z.b,null,[z.g]),e.xb(4608,z.f,z.j,[z.b,e.r]),e.xb(4608,z.c,z.c,[z.f]),e.xb(5120,z.a,function(n,l,t,e,u){return[n,new w.a(l,t,e,u)]},[z.o,b.a,q.k,q.a,z.c]),e.xb(4608,r.d,r.d,[]),e.xb(4608,I.a,I.a,[z.c]),e.xb(4608,j.a,j.a,[F.j,b.a]),e.xb(1073742336,q.m,q.m,[[2,q.r],[2,q.k]]),e.xb(1073742336,i.b,i.b,[]),e.xb(1073742336,r.r,r.r,[]),e.xb(1073742336,r.i,r.i,[]),e.xb(1073742336,z.e,z.e,[]),e.xb(1073742336,z.d,z.d,[]),e.xb(1073742336,r.p,r.p,[]),e.xb(1073742336,G.b,G.b,[]),e.xb(1073742336,E.a,E.a,[]),e.xb(1073742336,N,N,[]),e.xb(1073742336,o,o,[]),e.xb(256,z.l,"XSRF-TOKEN",[]),e.xb(256,z.m,"X-XSRF-TOKEN",[]),e.xb(1024,q.i,function(){return[[{path:"",component:u}]]},[])])})}}]);