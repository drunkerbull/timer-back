(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{ZAaW:function(n,l,u){"use strict";u.r(l);var t=u("8Y7J");class e{constructor(){}ngOnInit(){}}class s{}var o=u("pMnS"),i=u("SVse"),r=u("s7LF");class a{constructor(n,l){this.messagesService=n,this.storageService=l,this.rooms=[],this.usersSearch=[],this.currentRoom=null,this.form=new r.g({search:new r.e("")}),this.searchIsEmpty=!0}ngOnInit(){this.messagesService.getRooms(),this.form.get("search").valueChanges.subscribe(n=>{n&&n.length?(this.searchIsEmpty=!1,this.messagesService.getSearchUsers(n)):(this.usersSearch=[],this.searchIsEmpty=!0)}),this.messagesService.onRoom().subscribe(n=>{this.currentRoom=n,this.rooms.filter(n=>n._id===this.currentRoom._id).length||this.rooms.push(this.currentRoom)}),this.messagesService.onRooms().subscribe(n=>{this.rooms=n}),this.messagesService.onSearchUsers().subscribe(n=>{this.usersSearch=n})}selectUser(n){this.messagesService.selectOrCreateRoom(n),this.form.reset()}selectRoom(n){this.messagesService.selectRoom(n)}getRoomName(n){return n.name||2!==n.group.length?this.currentRoom.name:n.group.find(n=>n._id!==this.storageService.user._id).nickname}}var c=u("yMxI"),g=u("fbMX"),b=t.mb({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;width:25%;border-right:1px solid #000;height:calc(100vh - 76px)}.users-search[_ngcontent-%COMP%]{padding:16px;display:flex;border-bottom:1px solid grey}.users-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:4px}.search-list[_ngcontent-%COMP%]{background:silver}.rooms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .search-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{height:40px;display:flex;padding:8px;cursor:pointer}.rooms-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%], .rooms-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]:hover, .search-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%], .search-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]:hover{background:#708090}.rooms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover, .search-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#d3d3d3}.rooms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .room-avatar[_ngcontent-%COMP%], .search-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .room-avatar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20%}.rooms-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .room-avatar[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%], .search-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .room-avatar[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{background:grey;width:40px;border-radius:100%;height:40px}"]],data:{}});function m(n){return t.Eb(0,[(n()(),t.ob(0,0,null,null,4,"li",[],[[2,"selected",null]],[[null,"click"]],function(n,l,u){var t=!0;return"click"===l&&(t=!1!==n.component.selectRoom(n.context.$implicit)&&t),t},null,null)),(n()(),t.ob(1,0,null,null,1,"div",[["class","room-avatar"]],null,null,null,null,null)),(n()(),t.ob(2,0,null,null,0,"span",[["class","avatar"]],null,null,null,null,null)),(n()(),t.ob(3,0,null,null,1,"span",[["class","room-name"]],null,null,null,null,null)),(n()(),t.Db(4,null,["",""]))],null,function(n,l){var u=l.component;n(l,0,0,l.context.$implicit._id===(null==u.currentRoom?null:u.currentRoom._id)),n(l,4,0,u.getRoomName(l.context.$implicit))})}function d(n){return t.Eb(0,[(n()(),t.ob(0,0,null,null,2,"ul",[["class","rooms-list"]],null,null,null,null,null)),(n()(),t.db(16777216,null,null,1,null,m)),t.nb(2,278528,null,0,i.i,[t.N,t.K,t.r],{ngForOf:[0,"ngForOf"]},null)],function(n,l){n(l,2,0,l.component.rooms)},null)}function h(n){return t.Eb(0,[(n()(),t.ob(0,0,null,null,6,"li",[],null,[[null,"click"]],function(n,l,u){var t=!0;return"click"===l&&(t=!1!==n.component.selectUser(n.context.$implicit)&&t),t},null,null)),(n()(),t.ob(1,0,null,null,1,"div",[["class","room-avatar"]],null,null,null,null,null)),(n()(),t.ob(2,0,null,null,0,"span",[["class","avatar"]],null,null,null,null,null)),(n()(),t.ob(3,0,null,null,3,"span",[["class","room-name"]],null,null,null,null,null)),(n()(),t.Db(4,null,[" "," "])),(n()(),t.ob(5,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),t.Db(6,null,[" "," "]))],null,function(n,l){n(l,4,0,l.context.$implicit.nickname),n(l,6,0,l.context.$implicit.email)})}function p(n){return t.Eb(0,[(n()(),t.ob(0,0,null,null,2,"ul",[["class","search-list"]],null,null,null,null,null)),(n()(),t.db(16777216,null,null,1,null,h)),t.nb(2,278528,null,0,i.i,[t.N,t.K,t.r],{ngForOf:[0,"ngForOf"]},null)],function(n,l){n(l,2,0,l.component.usersSearch)},null)}function v(n){return t.Eb(0,[(n()(),t.db(16777216,null,null,1,null,p)),t.nb(1,16384,null,0,i.j,[t.N,t.K],{ngIf:[0,"ngIf"]},null),(n()(),t.db(0,null,null,0))],function(n,l){n(l,1,0,!l.component.searchIsEmpty)},null)}function f(n){return t.Eb(0,[(n()(),t.ob(0,0,null,null,11,"div",[["class","users-search"]],null,null,null,null,null)),(n()(),t.ob(1,0,null,null,10,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],function(n,l,u){var e=!0;return"submit"===l&&(e=!1!==t.xb(n,3).onSubmit(u)&&e),"reset"===l&&(e=!1!==t.xb(n,3).onReset()&&e),e},null,null)),t.nb(2,16384,null,0,r.v,[],null,null),t.nb(3,540672,null,0,r.h,[[8,null],[8,null]],{form:[0,"form"]},null),t.Ab(2048,null,r.b,null,[r.h]),t.nb(5,16384,null,0,r.m,[[4,r.b]],null,null),(n()(),t.ob(6,0,null,null,5,"input",[["formControlName","search"],["placeholder","search"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,l,u){var e=!0;return"input"===l&&(e=!1!==t.xb(n,7)._handleInput(u.target.value)&&e),"blur"===l&&(e=!1!==t.xb(n,7).onTouched()&&e),"compositionstart"===l&&(e=!1!==t.xb(n,7)._compositionStart()&&e),"compositionend"===l&&(e=!1!==t.xb(n,7)._compositionEnd(u.target.value)&&e),e},null,null)),t.nb(7,16384,null,0,r.c,[t.C,t.k,[2,r.a]],null,null),t.Ab(1024,null,r.j,function(n){return[n]},[r.c]),t.nb(9,671744,null,0,r.f,[[3,r.b],[8,null],[8,null],[6,r.j],[2,r.t]],{name:[0,"name"]},null),t.Ab(2048,null,r.k,null,[r.f]),t.nb(11,16384,null,0,r.l,[[4,r.k]],null,null),(n()(),t.ob(12,0,null,null,3,"div",[["class","list"]],null,null,null,null,null)),(n()(),t.db(16777216,null,null,1,null,d)),t.nb(14,16384,null,0,i.j,[t.N,t.K],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),t.db(0,[["searchList",2]],null,0,null,v))],function(n,l){var u=l.component;n(l,3,0,u.form),n(l,9,0,"search"),n(l,14,0,u.searchIsEmpty,t.xb(l,15))},function(n,l){n(l,1,0,t.xb(l,5).ngClassUntouched,t.xb(l,5).ngClassTouched,t.xb(l,5).ngClassPristine,t.xb(l,5).ngClassDirty,t.xb(l,5).ngClassValid,t.xb(l,5).ngClassInvalid,t.xb(l,5).ngClassPending),n(l,6,0,t.xb(l,11).ngClassUntouched,t.xb(l,11).ngClassTouched,t.xb(l,11).ngClassPristine,t.xb(l,11).ngClassDirty,t.xb(l,11).ngClassValid,t.xb(l,11).ngClassInvalid,t.xb(l,11).ngClassPending)})}class C{constructor(n,l){this.messagesService=n,this.storageService=l,this.currentRoom=null,this.form=new r.g({message:new r.e("")})}ngOnInit(){this.messagesService.onRoom().subscribe(n=>{this.currentRoom=n})}get groupList(){return this.currentRoom.group.map(n=>n.nickname).join(", ")}get roomName(){return this.currentRoom.name||2!==this.currentRoom.group.length?this.currentRoom.name:this.currentRoom.group.filter(n=>n._id!==this.storageService.user._id)[0].nickname}sendMessage(){const n={type:"message",room:this.currentRoom._id,owner:this.storageService.user._id,text:this.form.get("message").value};this.currentRoom.messages.push(n),this.messagesService.sendMessage(n),this.form.reset()}}var x=t.mb({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;width:75%;height:calc(100vh - 76px)}.messages-box[_ngcontent-%COMP%]{display:flex;height:100%;flex-flow:column;justify-content:space-between}.header[_ngcontent-%COMP%], .messages[_ngcontent-%COMP%]{padding:8px}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{height:calc(100vh - 225px);overflow-y:auto}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding-top:16px;padding-bottom:16px;display:flex;align-items:center}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]{width:15%;display:flex;align-items:center;justify-content:center}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .message-avatar[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{height:40px;width:40px;background:grey;border-radius:100%}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{width:85%;padding-right:16px}.messages[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.owner[_ngcontent-%COMP%]{background:#708090}.form[_ngcontent-%COMP%]{padding:8px;height:60px;display:flex;align-items:center;background:silver}"]],data:{}});function _(n){return t.Eb(0,[(n()(),t.ob(0,0,null,null,4,"li",[],[[2,"owner",null]],null,null,null,null)),(n()(),t.ob(1,0,null,null,1,"div",[["class","message-avatar"]],null,null,null,null,null)),(n()(),t.ob(2,0,null,null,0,"div",[["class","avatar"]],null,null,null,null,null)),(n()(),t.ob(3,0,null,null,1,"div",[["class","message-text"]],null,null,null,null,null)),(n()(),t.Db(4,null,[" "," "]))],null,function(n,l){n(l,0,0,l.context.$implicit.owner===l.component.storageService.user._id),n(l,4,0,l.context.$implicit.text)})}function O(n){return t.Eb(0,[(n()(),t.ob(0,0,null,null,22,"div",[["class","messages-box"]],null,null,null,null,null)),(n()(),t.ob(1,0,null,null,3,"div",[["class","header"]],null,null,null,null,null)),(n()(),t.Db(2,null,[" Room name: "," "])),(n()(),t.ob(3,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),t.Db(4,null,[" Group: [","] "])),(n()(),t.ob(5,0,null,null,3,"div",[["class","messages"]],null,null,null,null,null)),(n()(),t.ob(6,0,null,null,2,"ul",[],null,null,null,null,null)),(n()(),t.db(16777216,null,null,1,null,_)),t.nb(8,278528,null,0,i.i,[t.N,t.K,t.r],{ngForOf:[0,"ngForOf"]},null),(n()(),t.ob(9,0,null,null,13,"div",[["class","form"]],null,null,null,null,null)),(n()(),t.ob(10,0,null,null,12,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],function(n,l,u){var e=!0,s=n.component;return"submit"===l&&(e=!1!==t.xb(n,12).onSubmit(u)&&e),"reset"===l&&(e=!1!==t.xb(n,12).onReset()&&e),"ngSubmit"===l&&(e=!1!==s.sendMessage()&&e),e},null,null)),t.nb(11,16384,null,0,r.v,[],null,null),t.nb(12,540672,null,0,r.h,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),t.Ab(2048,null,r.b,null,[r.h]),t.nb(14,16384,null,0,r.m,[[4,r.b]],null,null),(n()(),t.ob(15,0,null,null,5,"input",[["formControlName","message"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,l,u){var e=!0;return"input"===l&&(e=!1!==t.xb(n,16)._handleInput(u.target.value)&&e),"blur"===l&&(e=!1!==t.xb(n,16).onTouched()&&e),"compositionstart"===l&&(e=!1!==t.xb(n,16)._compositionStart()&&e),"compositionend"===l&&(e=!1!==t.xb(n,16)._compositionEnd(u.target.value)&&e),e},null,null)),t.nb(16,16384,null,0,r.c,[t.C,t.k,[2,r.a]],null,null),t.Ab(1024,null,r.j,function(n){return[n]},[r.c]),t.nb(18,671744,null,0,r.f,[[3,r.b],[8,null],[8,null],[6,r.j],[2,r.t]],{name:[0,"name"]},null),t.Ab(2048,null,r.k,null,[r.f]),t.nb(20,16384,null,0,r.l,[[4,r.k]],null,null),(n()(),t.ob(21,0,null,null,1,"button",[["type","submit"]],null,null,null,null,null)),(n()(),t.Db(-1,null,["Send"]))],function(n,l){var u=l.component;n(l,8,0,u.currentRoom.messages),n(l,12,0,u.form),n(l,18,0,"message")},function(n,l){var u=l.component;n(l,2,0,u.roomName),n(l,4,0,u.groupList),n(l,10,0,t.xb(l,14).ngClassUntouched,t.xb(l,14).ngClassTouched,t.xb(l,14).ngClassPristine,t.xb(l,14).ngClassDirty,t.xb(l,14).ngClassValid,t.xb(l,14).ngClassInvalid,t.xb(l,14).ngClassPending),n(l,15,0,t.xb(l,20).ngClassUntouched,t.xb(l,20).ngClassTouched,t.xb(l,20).ngClassPristine,t.xb(l,20).ngClassDirty,t.xb(l,20).ngClassValid,t.xb(l,20).ngClassInvalid,t.xb(l,20).ngClassPending)})}function P(n){return t.Eb(0,[(n()(),t.db(16777216,null,null,1,null,O)),t.nb(1,16384,null,0,i.j,[t.N,t.K],{ngIf:[0,"ngIf"]},null)],function(n,l){n(l,1,0,l.component.currentRoom)},null)}var M=t.mb({encapsulation:0,styles:[[".messages[_ngcontent-%COMP%]{display:flex;border-right:1px solid #000;border-left:1px solid #000;border-bottom:1px solid #000;background:#fff}"]],data:{}});function y(n){return t.Eb(0,[(n()(),t.ob(0,0,null,null,4,"div",[["class","messages"]],null,null,null,null,null)),(n()(),t.ob(1,0,null,null,1,"app-sidebar",[],null,null,null,f,b)),t.nb(2,114688,null,0,a,[c.a,g.a],null,null),(n()(),t.ob(3,0,null,null,1,"app-messages-box",[],null,null,null,P,x)),t.nb(4,114688,null,0,C,[c.a,g.a],null,null)],function(n,l){n(l,2,0),n(l,4,0)},null)}function S(n){return t.Eb(0,[(n()(),t.ob(0,0,null,null,1,"app-messages",[],null,null,null,y,M)),t.nb(1,114688,null,0,e,[],null,null)],function(n,l){n(l,1,0)},null)}var k=t.kb("app-messages",e,S,{},{},[]),R=u("IheW"),w=u("iInd"),I=u("XPwU"),E=u("yTb8"),N=u("NHGN"),j=u("EApP"),D=u("hrfs"),F=u("PCNd");class A{}u.d(l,"MessagesRoutingModuleNgFactory",function(){return T});var T=t.lb(s,[],function(n){return t.ub([t.vb(512,t.j,t.Y,[[8,[o.a,k]],[3,t.j],t.w]),t.vb(4608,i.l,i.k,[t.t,[2,i.t]]),t.vb(4608,r.s,r.s,[]),t.vb(4608,R.h,R.n,[i.c,t.A,R.l]),t.vb(4608,R.o,R.o,[R.h,R.m]),t.vb(4608,g.a,g.a,[w.k]),t.vb(4608,R.k,R.k,[]),t.vb(6144,R.i,null,[R.k]),t.vb(4608,R.g,R.g,[R.i]),t.vb(6144,R.b,null,[R.g]),t.vb(4608,R.f,R.j,[R.b,t.q]),t.vb(4608,R.c,R.c,[R.f]),t.vb(5120,R.a,function(n,l,u,t,e){return[n,new I.a(l,u,t,e)]},[R.o,g.a,w.k,w.a,R.c]),t.vb(4608,r.d,r.d,[]),t.vb(4608,E.a,E.a,[R.c]),t.vb(4608,N.a,N.a,[j.j,g.a]),t.vb(1073742336,w.m,w.m,[[2,w.r],[2,w.k]]),t.vb(1073742336,i.b,i.b,[]),t.vb(1073742336,r.r,r.r,[]),t.vb(1073742336,r.i,r.i,[]),t.vb(1073742336,R.e,R.e,[]),t.vb(1073742336,R.d,R.d,[]),t.vb(1073742336,r.p,r.p,[]),t.vb(1073742336,D.b,D.b,[]),t.vb(1073742336,F.a,F.a,[]),t.vb(1073742336,A,A,[]),t.vb(1073742336,s,s,[]),t.vb(256,R.l,"XSRF-TOKEN",[]),t.vb(256,R.m,"X-XSRF-TOKEN",[]),t.vb(1024,w.i,function(){return[[{path:"",component:e}]]},[])])})}}]);